<?php
 use WHMCS\Database\Capsule; goto z2LHc; MqvOR: header("\x43\x6f\156\x74\x65\156\164\55\x54\x79\160\x65\72\40\x61\x70\x70\154\151\x63\x61\164\151\157\x6e\x2f\152\x73\x6f\x6e"); goto MIlOx; lPRCR: if (trim($checkOutput) !== "\x65\x78\x69\x73\164\x73") { die("\x45\x78\160\157\162\x74\x20\146\151\x6c\x65\x20\156\x6f\x74\40\146\157\165\x6e\x64"); } goto RxfMW; qRyjU: if (!preg_match("\x2f\x5e\x77\x6f\x72\x6b\x66\x6c\x6f\x77\163\137\56\52\134\56\x6a\x73\x6f\x6e\44\x2f\x69", $filename)) { die("\111\x6e\x76\141\x6c\x69\x64\40\x65\170\x70\x6f\x72\x74\x20\x66\x69\x6c\x65\156\x61\x6d\145"); } goto ZgweG; dE8h2: $filename = preg_replace("\x2f\134\163\x2b\x2f", '', basename($filename)); goto qRyjU; WORl_: if (!$server) { die("\x53\x65\162\x76\145\x72\x20\x6e\x6f\x74\x20\146\x6f\165\156\144"); } goto dE8h2; J90Ab: if (!isset($_SESSION["\165\151\x64"])) { die("\x55\156\141\165\164\150\157\162\151\172\145\x64"); } goto OW22G; mhq2i: $service = Capsule::table("\164\x62\154\150\x6f\x73\164\x69\156\x67")->where("\151\x64", $serviceId)->where("\165\163\145\162\151\144", $userId)->first(); goto Zcs7C; z2LHc: require_once "\56\56\x2f\x2e\x2e\x2f\56\56\x2f\151\156\x69\x74\56\x70\x68\x70"; goto nPAFT; pv5KI: $exportPath = "\x2f\166\141\x72\x2f\x77\x77\x77\x2f\x64\x6f\143\153\145\162\x6e\x38\x6e\57\145\x78\160\157\162\x74\163\57\x73\x65\x72\166\x69\143\x65\55{$serviceId}\x2f{$filename}"; goto ORwo9; rWeT7: header("\x43\141\x63\x68\x65\55\x43\x6f\x6e\x74\x72\x6f\154\x3a\40\156\157\55\143\141\x63\150\145"); goto Hdide; Zcs7C: if (!$service) { die("\123\145\162\166\151\143\x65\x20\x6e\x6f\x74\40\146\x6f\165\x6e\x64\x20\157\162\40\141\143\x63\145\163\x73\x20\x64\x65\156\151\x65\144"); } goto bC3zJ; RxfMW: $cmdRead = "\143\141\x74\40{$exportPath}"; goto JLPLo; cEJYU: $filename = $_REQUEST["\146\151\x6c\145\156\x61\x6d\x65"] ?? ''; goto xOk5X; JLPLo: $content = dockern8n_ssh_RunCommand($hostname, $username, $password, $cmdRead); goto MqvOR; OW22G: $userId = $_SESSION["\x75\151\x64"]; goto QGjXK; RgiA5: header("\x43\x6f\156\x74\145\x6e\x74\55\114\x65\156\x67\164\x68\x3a\40" . strlen($content)); goto rWeT7; bC3zJ: $server = Capsule::table("\x74\142\x6c\x73\x65\162\166\x65\x72\163")->where("\151\144", $service->server)->first(); goto WORl_; Hdide: echo $content; goto EaB2v; ZgweG: $hostname = $server->hostname ?: $server->ipaddress; goto NFher; MIlOx: header("\x43\x6f\x6e\x74\x65\156\x74\55\x44\151\x73\160\x6f\x73\151\164\x69\x6f\156\x3a\40\141\164\164\141\x63\x68\x6d\145\156\x74\x3b\40\x66\151\154\145\156\x61\x6d\145\x3d\42" . $filename . "\x22"); goto RgiA5; xOk5X: if (empty($serviceId) || empty($filename)) { die("\111\x6e\166\x61\154\x69\144\x20\160\141\x72\141\x6d\145\164\x65\x72\x73"); } goto mhq2i; ORwo9: $cmdCheck = "\x74\145\x73\164\40\55\x66\40{$exportPath}\x20\46\46\x20\x65\x63\x68\157\40\47\x65\x78\151\163\164\x73\x27"; goto STcvf; nPAFT: require_once "\144\157\x63\153\145\162\156\x38\156\x2e\x70\150\x70"; goto J90Ab; QGjXK: $serviceId = $_REQUEST["\x73\145\x72\166\151\143\145\111\x64"] ?? $_REQUEST["\163\x65\162\x76\151\143\145\151\x64"] ?? 0; goto cEJYU; STcvf: $checkOutput = dockern8n_ssh_RunCommand($hostname, $username, $password, $cmdCheck); goto lPRCR; NFher: $username = $server->username; goto BiX3w; BiX3w: $password = decrypt($server->password); goto pv5KI; EaB2v: die;