<?php
 use WHMCS\Database\Capsule; goto YNW7c; Ys649: if (!isset($_SESSION["\165\151\144"])) { die("\x55\x6e\141\165\x74\150\157\x72\x69\x7a\145\144"); } goto AQzE_; sdSkw: header("\x43\x6f\156\164\x65\156\164\55\104\x69\x73\x70\157\163\x69\x74\151\x6f\156\72\x20\x61\164\164\x61\143\150\155\x65\x6e\x74\x3b\40\x66\151\x6c\x65\x6e\141\155\145\75\x22" . $backupFilename . "\42"); goto Hp76p; O_S1C: $service = Capsule::table("\x74\x62\x6c\150\x6f\163\164\x69\x6e\x67")->where("\151\144", $serviceId)->where("\x75\x73\x65\162\151\144", $userId)->first(); goto fmwZB; PN4BY: $serviceId = $_REQUEST["\163\145\162\x76\x69\143\145\151\144"] ?? 0; goto Cj8h0; vFp1J: $cmdSize = "\163\164\x61\x74\x20\55\143\x25\163\40{$backupPath}"; goto rZmcT; MsSwI: if (empty($serviceId) || empty($backupFilename)) { die("\x49\x6e\x76\141\154\x69\144\40\x70\141\x72\x61\155\145\x74\145\x72\163"); } goto O_S1C; Pqd5F: $server = Capsule::table("\x74\x62\x6c\x73\145\x72\166\145\x72\163")->where("\x69\x64", $service->server)->first(); goto AULVu; jlZk5: try { $ssh = new \phpseclib3\Net\SSH2($hostname); if (!$ssh->login($username, $password)) { die("\123\123\110\x20\141\165\x74\150\x65\x6e\164\151\x63\x61\164\151\157\x6e\x20\x66\141\151\154\145\144"); } echo $ssh->exec($cmd); $ssh->disconnect(); } catch (Exception $e) { die("\104\157\x77\x6e\x6c\157\x61\144\x20\x66\141\151\154\145\x64\72\x20" . $e->getMessage()); } goto s4Z7K; vW1AG: header("\103\x6f\x6e\x74\x65\156\x74\x2d\124\171\x70\145\x3a\40\141\160\160\154\151\143\141\x74\x69\157\x6e\57\x67\x7a\151\x70"); goto sdSkw; Cj8h0: $backupFilename = $_REQUEST["\142\141\x63\x6b\165\160\137\x66\151\154\145\156\141\155\145"] ?? ''; goto MsSwI; b8nIg: if (!preg_match("\57\x5e\x6e\x38\x6e\55\142\x61\143\x6b\165\x70\x2d\134\144\173\x38\175\55\134\x64\x7b\x36\175\x5c\x2e\164\141\x72\134\56\x67\x7a\x24\x2f", $backupFilename)) { die("\x49\x6e\166\141\x6c\151\144\40\x62\x61\143\x6b\x75\x70\40\x66\x69\x6c\x65\156\x61\155\145"); } goto udsZH; aJ58c: $username = $server->username; goto caueV; Gr8oV: if (trim($checkOutput) !== "\x65\x78\151\163\x74\163") { die("\x42\141\x63\153\x75\x70\x20\x66\151\x6c\x65\x20\x6e\x6f\164\x20\146\157\165\x6e\x64"); } goto vFp1J; nFRg9: $checkOutput = dockern8n_ssh_RunCommand($hostname, $username, $password, $cmdCheck); goto Gr8oV; AQzE_: $userId = $_SESSION["\x75\151\144"]; goto PN4BY; g3q4N: $backupPath = "\57\x76\141\162\x2f\x77\x77\167\57\144\157\x63\x6b\x65\x72\x6e\70\156\57\142\x61\x63\x6b\165\160\x73\57\x73\x65\x72\x76\151\143\x65\55{$serviceId}\x2f{$backupFilename}"; goto LOIv1; rZmcT: $fileSize = trim(dockern8n_ssh_RunCommand($hostname, $username, $password, $cmdSize)); goto vW1AG; LOIv1: $cmdCheck = "\x74\145\x73\x74\40\55\146\40{$backupPath}\40\46\46\x20\145\143\x68\x6f\40\47\145\170\x69\x73\x74\x73\47"; goto nFRg9; YNW7c: require_once "\56\56\57\x2e\x2e\57\56\56\x2f\x69\x6e\x69\x74\x2e\x70\x68\x70"; goto mxdtZ; fmwZB: if (!$service) { die("\123\145\162\x76\151\x63\145\40\156\157\x74\40\x66\x6f\x75\156\x64\x20\x6f\162\x20\141\143\x63\145\163\163\40\144\145\x6e\151\145\144"); } goto Pqd5F; Hp76p: header("\103\157\156\x74\145\156\164\x2d\x4c\145\x6e\x67\x74\x68\72\40" . $fileSize); goto KjClS; KjClS: header("\103\x61\143\x68\x65\x2d\103\x6f\156\164\162\x6f\x6c\72\40\156\x6f\x2d\x63\x61\143\x68\145"); goto niaY6; niaY6: $cmd = "\x63\141\164\x20{$backupPath}"; goto jlZk5; jQOYP: $backupFilename = basename($backupFilename); goto b8nIg; udsZH: $hostname = $server->hostname ?: $server->ipaddress; goto aJ58c; mxdtZ: require_once "\144\157\x63\153\145\x72\x6e\x38\x6e\56\160\150\160"; goto Ys649; caueV: $password = decrypt($server->password); goto g3q4N; AULVu: if (!$server) { die("\x53\145\162\166\145\x72\x20\156\157\164\x20\146\157\x75\156\x64"); } goto jQOYP; s4Z7K: die;